# goStoreShopPay ()

| 需求模块         | 需求子项                                                     | 具体逻辑描述                                                 | 触发条件 / 参数                                              | 预期结果                                                     |
| ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 前置校验模块     | 用户身份凭证（aid）获取与判断                                | 从全局存储（global.data）中获取用户 aid，校验其有效性        | 无主动触发条件，函数调用时自动执行；依赖全局存储中 “aid” 字段 | 1. 若 aid 存在且非空：进入「店铺状态校验模块」2. 若 aid 不存在 / 为空：直接跳转至 StoreShopPay 页面（无参数） |
| 店铺状态校验模块 | 调用 `/client/shop/newShops` 接口                            | aid 有效时，无参数调用该接口，获取用户关联的店铺状态数据，同时打印接口日志（url、params、res） | 前置校验通过（aid 有效）                                     | 接口请求成功，返回店铺状态数据（res.entity）或失败信息       |
|                  | 接口成功（res.success = true）判断与跳转                     | 校验返回的 res.entity，判断是否存在待处理的新店铺或账单      | 接口返回 res.success = true，且 res.entity 存在              | 1. 若 newShopAmount > 0 或 clientBill 存在：跳转至 AddShopMsg 页面，携带参数（pageName:Home、clientBill、shopNumber <数字型>、oldshop）2. 不满足上述条件：进入「接口失败处理子项」 |
|                  | 接口失败（res.success = false）处理                          | 调用 `/client/clientUser/loginData` 接口（无参数），获取最新用户信息 | 接口返回 res.success = false                                 | 1. 接口请求成功：获取用户信息（rst.entity），存储到 global.data.appUser2. 进入「支付页面跳转模块」 |
| 支付页面跳转模块 | 用户信息存在且含客户端数据（rst.entity && rst.entity.client）时跳转 | 根据用户来源（createSource_）判断跳转参数                    | 接口失败处理后，rst.entity 存在且 rst.entity.client 非空     | 1. 若 createSource_ = "Official"：跳转至 StoreShopPay 页面（无参数）2. 若 createSource_ ≠ "Official"：跳转至 StoreShopPay 页面，携带参数（repage:"UpShop"） |
|                  | 用户信息不存在 / 无客户端数据时跳转                          | 无需额外判断，直接跳转                                       | 接口失败处理后，rst.entity 不存在 或 rst.entity.client 为空  | 跳转至 StoreShopPay 页面（无参数）                           |





# getSystemConfig ()

| 需求模块               | 需求子项               | 具体逻辑描述                                                 | 触发条件 / 参数                                              | 预期结果                                                     |
| ---------------------- | ---------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 接口请求模块           | 构造请求参数与调用接口 | 1. 确定请求地址为 `/client/appUser/systemPrices`，初始化空参数对象<br />2. 若 `this.openshow` 为 true，添加参数 `newClient: 1`；若 `this.state.isOpenMonth` 为 true，添加参数 `type: 'MONTH'`<br />3. 调用 `this.request()` 发起请求 | 函数被调用时自动触发；依赖 `openshow`（新客户标识）、`state.isOpenMonth`（月度类型标识）两个状态 | 接口请求成功，返回系统配置数据（含 `systemPrices`、`orderShowJson` 等字段）；请求失败则进入错误处理（代码中未显式定义，默认按无数据处理） |
| 数据解析与基础处理模块 | 解析接口返回的核心数据 | 1. 校验返回数据 `res` 非空、`res.entity` 存在且 `res.entity.systemPrices` 为非空数组<br />2. 解析 `res.entity.orderShowJson`（模块显示排序配置）、`res.entity.versionOperateJson`（版本操作配置）为 JSON 对象<br />3. 初始化 `rows` 数组（存储模块配置数据）、`shopMoneyOne`（单店铺金额，初始为 0） | 接口返回 `res.success = true` 且核心数据结构完整             | 成功解析配置 JSON，获取 `systemPrices` 模块列表、`orderShowArr` 显示排序、`versionOperateArr` 版本操作数据，为后续模块处理做准备 |































